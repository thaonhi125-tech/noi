<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N ∆°i - C·ªông ƒë·ªìng NhiLe</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R0LZL5XTQ0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-R0LZL5XTQ0');
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Japandi Color Palette & Custom Styles */
        :root {
            --bg-color: #FBF9F5;
            --primary-color: #8B5E3C;
            --primary-light: #C4A484;
            --text-color: #2D2D2D;
            --white: #FFFFFF;
            --yellow-accent: #FBBF24;
            --yellow-light: #FEF3C7;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #C4A484; border-radius: 10px; }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.6s ease-out forwards; }

        @keyframes pulse-custom {
            0%, 100% { box-shadow: 0 0 0 0 rgba(139, 94, 60, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(139, 94, 60, 0); }
        }
        .animate-pulse-ring { animation: pulse-custom 2s infinite; }

        /* UI Elements */
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08);
        }

        .nav-item.active { 
            background-color: var(--yellow-light);
            color: var(--primary-color); 
            font-weight: bold; 
        }

        .ai-float {
            position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px;
            background-color: var(--primary-color); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); cursor: pointer;
            z-index: 40; color: white; font-size: 24px;
        }

        .chart-container { position: relative; width: 100%; max-width: 600px; height: 300px; margin: 0 auto; }
        
        .google-btn {
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        .google-btn:hover { background-color: #f9fafb; transform: translateY(-1px); }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .story-ring {
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            padding: 2px;
            border-radius: 50%;
        }
        .story-avatar {
            border: 2px solid white;
            border-radius: 50%;
        }

        /* Sidebar Styles */
        #sidebar {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden text-gray-800 bg-[#FBF9F5]">

    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="absolute md:relative z-50 md:z-auto bg-white w-64 h-full flex-shrink-0 shadow-lg md:shadow-none transform -translate-x-full md:translate-x-0 flex flex-col">
        <div class="p-4 border-b border-gray-100 flex items-center space-x-3">
            <div class="w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center font-bold text-amber-800">N</div>
            <div>
                <p class="text-sm font-bold">Nhi Le</p>
                <p class="text-xs text-gray-500">H·∫°t gi·ªëng ti·ªÅm nƒÉng</p>
            </div>
        </div>
        <nav class="flex-1 p-2 space-y-2">
            <button class="nav-item w-full flex items-center space-x-3 p-3 rounded-xl" data-tab="home" onclick="app.navigate('home')">
                <span class="text-lg">üìñ</span>
                <span class="text-sm font-medium">H·ªçc T·∫≠p</span>
            </button>
            <button class="nav-item w-full flex items-center space-x-3 p-3 rounded-xl" data-tab="community" onclick="app.navigate('community')">
                <span class="text-lg">ü§ù</span>
                <span class="text-sm font-medium">K·∫øt N·ªëi</span>
            </button>
            <button class="nav-item w-full flex items-center space-x-3 p-3 rounded-xl" data-tab="live" onclick="app.navigate('live')">
                <span class="text-lg">‚óé</span>
                <span class="text-sm font-medium">Live Hub</span>
            </button>
            <button class="nav-item w-full flex items-center space-x-3 p-3 rounded-xl" data-tab="profile" onclick="app.navigate('profile')">
                <span class="text-lg">üéì</span>
                <span class="text-sm font-medium">T√¥i</span>
            </button>
        </nav>
        <div class="p-4 border-t border-gray-100">
             <button class="w-full flex items-center space-x-3 p-3 rounded-xl bg-gray-50 hover:bg-gray-100 transition">
                <span class="text-lg">‚öôÔ∏è</span>
                <span class="text-sm font-medium">C√†i ƒë·∫∑t</span>
            </button>
        </div>
    </aside>

    <!-- Sidebar Overlay for mobile -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden md:hidden" onclick="app.toggleSidebar()"></div>

    <!-- Auth Section -->
    <div id="auth-container" class="fixed inset-0 z-[100] bg-[#FBF9F5] flex flex-col items-center justify-center px-8 text-center">
        <!-- ... Auth content remains the same ... -->
    </div>

    <!-- Main App Wrapper -->
    <div id="main-app" class="hidden flex flex-col h-full w-full">
        <!-- Header Section -->
        <header id="main-header" class="flex-none px-4 pt-6 pb-4 bg-transparent z-10">
            <!-- Header content will be rendered by JS -->
        </header>

        <!-- Main Content Area -->
        <main id="app-content" class="flex-1 overflow-y-auto relative scroll-smooth no-scrollbar">
            <!-- Content injected via JS -->
        </main>

        <!-- AI Floating Assistant -->
        <div id="ai-trigger" class="ai-float animate-pulse-ring hidden" onclick="app.toggleAIChat()">
            üßò
        </div>

        <!-- AI Chat Modal -->
        <div id="ai-modal" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-end sm:items-center justify-center transition-opacity duration-300">
             <!-- ... AI modal content remains the same ... -->
        </div>

        <!-- NO MORE BOTTOM NAVIGATION -->
    </div>

    <script>
        const store = {
            // ... Store object remains the same ...
        };

        const app = {
            init: () => {
                // Initial setup: Start on home tab
                app.navigate('home');
            },
            
            toggleSidebar: () => {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('sidebar-overlay');
                sidebar.classList.toggle('-translate-x-full');
                overlay.classList.toggle('hidden');
            },

            signIn: () => {
                const authScreen = document.getElementById('auth-container');
                const mainApp = document.getElementById('main-app');
                const aiTrigger = document.getElementById('ai-trigger');
                
                authScreen.classList.add('transition-opacity', 'duration-500', 'opacity-0');
                setTimeout(() => {
                    authScreen.classList.add('hidden');
                    mainApp.classList.remove('hidden');
                    aiTrigger.classList.remove('hidden');
                    store.isLoggedIn = true;
                    app.render('home'); // Start at home
                    app.checkWakeUpCall();
                }, 500);
            },

            navigate: (tab) => {
                // Highlight active nav item
                document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                document.querySelector(`.nav-item[data-tab="${tab}"]`).classList.add('active');
                
                // Close sidebar on mobile after navigation
                if (window.innerWidth < 768) {
                    app.toggleSidebar();
                }

                app.render(tab);
            },

            render: (tab) => {
                const container = document.getElementById('app-content');
                const header = document.getElementById('main-header');
                container.innerHTML = '';
                header.innerHTML = ''; 
                
                // Always render header with menu button
                app.renderHeader(header, tab);

                if(tab === 'home') app.renderHome(container);
                else if(tab === 'community') app.renderCommunity(container);
                else if(tab === 'live') app.renderLive(container);
                else if(tab === 'profile') app.renderProfile(container);
            },
            
            renderHeader: (header, tab) => {
                const titleMap = {
                    'home': 'H·ªçc T·∫≠p',
                    'community': 'K·∫øt N·ªëi',
                    'live': 'Live Hub',
                    'profile': 'Trang c√° nh√¢n'
                };
                header.innerHTML = `
                    <div class="flex justify-between items-center fade-in">
                        <div class="flex items-center space-x-3">
                            <button onclick="app.toggleSidebar()" class="md:hidden text-2xl p-2 -ml-2">‚ò∞</button>
                            <h1 class="text-2xl font-bold tracking-tight">${titleMap[tab]}</h1>
                        </div>
                        <div class="flex items-center space-x-2 bg-white rounded-full px-3 py-1.5 shadow-sm border border-gray-100 cursor-pointer" onclick="app.showTrustScoreDetails()">
                            <span class="text-yellow-500 text-lg">üèÜ</span>
                            <span class="font-bold text-sm" id="trust-score-display">${store.user.trustScore}</span>
                        </div>
                    </div>
                `;
            },
            
            renderHome: (container) => { /* ... remains the same ... */ },
            renderCommunity: (container) => { /* ... remains the same ... */ },
            renderLive: (container) => { /* ... remains the same ... */ },
            renderProfile: (container) => { /* ... remains the same ... */ },
            initChart: () => { /* ... remains the same ... */ },
            checkWakeUpCall: () => { /* ... remains the same ... */ },
            toggleAIChat: (forceOpen = false) => { /* ... remains the same ... */ },
            sendMessage: () => { /* ... remains the same ... */ },
            addAIMessage: (text) => { /* ... remains the same ... */ },
            giveSeed: (btn) => {
                 // Animation & Feedback
                btn.classList.add('scale-150');
                setTimeout(() => btn.classList.remove('scale-150'), 200);
                
                // Logic update trust score (simulated)
                store.user.trustScore += 1;
                document.getElementById('trust-score-display').innerText = store.user.trustScore;
            },
            showTrustScoreDetails: () => {
                alert(`Trust Score: ${store.user.trustScore}\n\nB·∫°n ƒëang l√† "H·∫°t gi·ªëng Ti·ªÅm nƒÉng".\n\nƒêi·ªÉm s·ªë n√†y th·ªÉ hi·ªán s·ª± tin t∆∞·ªüng c·ªßa c·ªông ƒë·ªìng qua c√°c ƒë√≥ng g√≥p v√† k·ª∑ lu·∫≠t h·ªçc t·∫≠p c·ªßa b·∫°n. H√£y ti·∫øp t·ª•c duy tr√¨!`);
            }
        };

        // Simplified content for other render functions to keep the snippet shorter
        app.renderHome = (container) => container.innerHTML = '<div class="p-4"><h1>Home Content</h1></div>';
        app.renderCommunity = (container) => container.innerHTML = '<div class="p-4"><h1>Community Content</h1></div>';
        app.renderLive = (container) => container.innerHTML = '<div class="p-4"><h1>Live Hub Content</h1></div>';
        app.renderProfile = (container) => container.innerHTML = '<div class="p-4"><h1>Profile Content</h1></div>';
        
        // Ensure the original full functions are kept in the actual implementation
        // The above is just for brevity in this example response.

        document.addEventListener('DOMContentLoaded', app.init);
    </script>
</body>
</html>
